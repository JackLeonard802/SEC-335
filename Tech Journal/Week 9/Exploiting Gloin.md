# Exploiting Gloin

## Target IP Address
I was able to use my [dns-resolver.sh](https://github.com/JackLeonard802/SEC-335/blob/main/Tech%20Journal/Source%20Code/dns-resolver.sh) script against the target network to enumerate the dns records for all of the hosts, including Gloin.
> note: The IP addresses are given in the reverse format

![image](https://user-images.githubusercontent.com/71239122/200626591-190151e7-2239-44e0-a26c-a469b40c52c2.png)

## Open Ports
![image](https://user-images.githubusercontent.com/71239122/200627213-e9219f3d-6929-46a5-94ae-1df78f866f0c.png)

I was able to use nmap with the -sV flags on the host to scan ports 1-1000 and get the services running on those ports

## Discovered Vulnerability

By using DirBuster (dirb) I was able to enumerate the apache site and find a number of directories titled by a number of variations of "admin"
* `dirb https://10.0.5.31/entrance_exam/ -l`

<img width="646" alt="Screenshot 2022-11-09 at 7 48 42 PM" src="https://user-images.githubusercontent.com/71239122/200973228-ea578897-d83a-48b0-b6ef-2067d34ef0e4.png">

Notably, there are a couple of paths with .php extensions (admin/index/login) that I could explore

<img width="1434" alt="Screenshot 2022-11-09 at 7 52 10 PM" src="https://user-images.githubusercontent.com/71239122/200973693-062651c1-de74-4856-bb3a-588a527e1493.png">

> This is what I was presented with by https://10.0.5.31/entrance_exam/admin/admin.php

<img width="626" alt="Screenshot 2022-11-09 at 7 55 01 PM" src="https://user-images.githubusercontent.com/71239122/200973983-9a209047-6a81-4d82-92f7-293120303eaf.png">

> This is what I was presented with by the same URL using ./index.php and ./login.php

After a little bit of poking around on the internet, I was able to craft a command using hydra to try to brute force the password for the user "admin"
* `sudo hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.0.5.31 https-post-form "/entrance_exam/admin/login.php:username=admin&password=^PASS^:Invalid username or password."`
* `https-post-form` to specify form type
* `:username=admin&password=^PASS^` specifies the format of the request, and `^PASS^` defines where to insert the guessed password
* `:Invalid username or password.` specifies the verbiage given at an incorrect request

<img width="707" alt="Screenshot 2022-11-09 at 8 27 54 PM" src="https://user-images.githubusercontent.com/71239122/200977952-bc831106-8555-43ff-85ce-8bdb7e8060c3.png">

> These were the results of my brute force
> ...and none of the passwords worked.

## How you achieved a foothold

I needed to cut my losses, so I wen't over to exploit-db and sure enough there were multiple entries for this web app. One entry in particular gave me some valuable information.

https://www.exploit-db.com/exploits/50398

I learned that the site is vulnerable to SQL injection, and by entering the URL below I achieved some very interesting results.

`http://127.0.0.1/entrance_exam/admin/view_enrollee.php?id=1'+UNION+SELECT+1,2,3,4,5,6,password,username,9,10,11,12,13,14,15+FROM+admin_list;`

![image](https://user-images.githubusercontent.com/71239122/201966531-392f5726-a013-4aec-af3c-9153fb271ea6.png)

> Looks like we have a hash here!

I decided to take it to a simple web-based has cracker and...

![image](https://user-images.githubusercontent.com/71239122/201968241-d8b69f46-1f62-469b-bbae-0bf695d75458.png)

> Voila!

Now, I just need to use the credentials in the administrative login page and...

![image](https://user-images.githubusercontent.com/71239122/201969764-25df6ed5-1bc6-439a-a5e1-b6c64bc69402.png)

> I'm in the mainframe (lol).

![image](https://user-images.githubusercontent.com/71239122/201974924-2214d37c-db7e-41ff-8f57-820ba7bb2610.png)


Since this is a Windows system I connected to the system using RDP with Remmina. The username I used was Administrator and the password remained the same


## How you achieved root/Administrative level compromise

After checking the permissions of the user in lusrmgr.msc I found that I had indeed achieved full admin access

![image](https://user-images.githubusercontent.com/71239122/201975403-3055f2ea-82b4-46ff-aa19-a057ebd34537.png)


## User Flag

Here is the flag for the user gloin
![image](https://user-images.githubusercontent.com/71239122/201977451-47933102-8145-4f27-890d-950ea16c249f.png)


## Root Flag

Here is the flag for the Administrator
![image](https://user-images.githubusercontent.com/71239122/201977673-4a8ccc3f-9622-4436-8685-b6da3843340a.png)


## How might the vulnerabilities be mitigated by the systems administrator and developer?

Some major vulnerablilities in this system were duplicate passwords and, of course the SQL
